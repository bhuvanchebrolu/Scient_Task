<%- include('../partials/header', { title }) %>

<main class="container mt-5">
  <div class="card shadow p-4">
    <h1 class="mb-3"><%= project.title %></h1>
    <p class="text-muted">Created by <strong><%= project.professor.name %></strong></p>

    <p><%= project.description %></p>

    <div class="mt-4 d-flex flex-wrap gap-2">
      <% if (user && user._id.toString() === project.professor._id.toString()) { %>
        <a href="/professor/projects/<%= project._id %>/edit" class="btn btn-warning">
          <i class="fas fa-edit me-1"></i>Edit
        </a>
        <form action="/professor/projects/<%= project._id %>?_method=DELETE" method="POST" class="d-inline">
          <button class="btn btn-danger" onclick="return confirm('Are you sure?')">
            <i class="fas fa-trash me-1"></i>Delete
          </button>
        </form>
      <% } %>

      <% if (user && user.role === 'student') { 
        let isAssigned = project.students.some(s => s._id.toString() === user._id.toString());
      %>
        <% if (isAssigned) { %>
          <form class="d-inline">
            <button class="btn btn-outline-danger">
              <i class="fas fa-user-minus me-1"></i>Leave Project
            </button>
          </form>
          <span class="btn btn-success disabled">
            <i class="fas fa-check me-2"></i>You're Assigned
          </span>
        <% } else { %>
          <form  class="d-inline">
            <button class="btn btn-primary">
              <i class="fas fa-user-plus me-2"></i>Join Project
            </button>
          </form>
        <% } %>
      <% } %>
    </div>

    <!-- Share buttons -->
    <div class="mt-4">
      <h5>Share this project:</h5>
      <button class="btn btn-outline-primary me-2">
        <i class="fas fa-envelope me-1"></i>Email
      </button>
      <button class="btn btn-outline-success" >
        <i class="fab fa-whatsapp me-1"></i>WhatsApp
      </button>
      <input type="hidden" id="projectUrl" value="<%= request.protocol + '://' + request.get('host') + request.originalUrl %>">
    </div>
  </div>
</main>



<%- include('../partials/footer') %>
